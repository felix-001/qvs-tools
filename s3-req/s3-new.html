<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Radio Button Selection and Sending Data</title>
<script>
// 假设后端API接口URL
const backendApi = 'http://127.0.0.1:8080';

// 获取数据并填充单选按钮
function fetchData() {
  console.log("fetchData");
  fetch(backendApi)
    .then(response => response.json())
    .then(data => {
      const radiosContainer = document.getElementById('radios');
      data.forEach((item, index) => {
        console.log("item:", item);
        const radio = document.createElement('input');
        radio.type = 'radio';
        radio.name = 'selectedItem';
        radio.value = item.id;
        radio.id = `radio-${item.id}`;
        const label = document.createElement('label');
        label.htmlFor = radio.id;
        label.textContent = item.name;
        radiosContainer.appendChild(radio);
        radiosContainer.appendChild(label);
        radiosContainer.appendChild(document.createElement('br'));
      });
    })
    .catch(error => console.error('Error fetching data:', error));
}

// 发送选中的数据到后端
function sendData() {
  const radios = document.getElementsByName('selectedItem');
  for (let i = 0; i < radios.length; i++) {
    if (radios[i].checked) {
      const selectedItem = radios[i].value;
      const dataToSend = { selectedItem };
      fetch(backendApi, {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json'
        },
        body: JSON.stringify(dataToSend)
      })
      .then(response => response.json())
      .then(data => {
        console.log('Data sent:', data);
        // 这里可以添加发送数据后的逻辑，比如显示反馈信息
      })
      .catch(error => console.error('Error sending data:', error));
      break; // 找到选中的单选按钮后退出循环
    }
  }
}

// 页面加载时获取数据
document.addEventListener('DOMContentLoaded', fetchData);
</script>
</head>
<body>
<h1>Radio Button Selection</h1>
<div id="radios">
  <!-- 单选按钮将在这里生成 -->
</div>
<button onclick="sendData()">Send</button>
</body>
</html>
